
<div class="container">
  <%= form_tag activities_path, method: :get do %>
  <%= text_field_tag :address, params[:address], class: "form-control", id: "friend_places", placeholder: "Search for a specific address within a 5km radius" %>
  <%= text_field_tag :activity, params[:activity], class: "form-control", placeholder: "Search for a specific activity"%>
  <%# @category = ["sports", "food", "nightlife", "culture", "nature", "wellness", "networking", "learning"]%>
  <%= select_tag(:category, options_for_select(["🍝 food & drinks", "🍻 nightlife", "🎭 culture", "🌳 nature", "🧘‍♀️ wellness", "🤝 networking", "📚 learning"]), :include_blank => true) %>
  <%= submit_tag "filter for category", class: "btn btn-primary" %>
  <% end %>

  <div class="content-map">
    <div>
      <% @activities.each do |activity| %>
        <br>
        <% if activity.datetime > Time.current && activity.bookings.count < activity.capacity %>
          <h1><strong><%= link_to activity.name, activity_path(activity) %></strong></h1>

          <br>
          <% activity.photos.each do |photo| %>
          <%= cl_image_tag photo.key, height: 300, width: 400, crop: :fit %>
          <% end %>
          <br>
          When: <%= activity.datetime.strftime("%b %eth %Y, %k:%M") %>
          <br>
          <% if params[:address].present? %>
            Where: <%= Geocoder::Calculations.distance_between(activity.to_coordinates, Geocoder.coordinates(params[:address])).round(1) %> km away @
            <%= activity.address %>
            <% else %>
            Where: <%= activity.address %>
          <% end %>
          <br>
          Capacity: <%= activity.capacity %>
          <br>
          Category: <%= activity.category %>
          <br>
          <% if activity.bookings.count == 1 %>
          <%= activity.bookings.count %> Person is going
          <% else %>
          <%= activity.bookings.count %> People are going
          <% end %>
          <br>
        <% end %>
      <% end %>
      <br>
    </div>

    <!-- <div class="map"
      id="map"
      style="width: 100%;
      height: 600px;"
      data-markers="<%#= @markers.to_json %>"
      data-mapbox-api-key="<%#= ENV['MAPBOX_API_KEY'] %>"
    ></div> -->
    </div>
  </div>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>

